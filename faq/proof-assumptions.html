<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>What is a proof assumption? - CBMC</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> CBMC quick start</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation.html"><strong aria-hidden="true">1.1.</strong> CBMC installation</a></li><li class="chapter-item expanded "><a href="../cbmc/overview/unit-testing.html"><strong aria-hidden="true">1.2.</strong> CBMC as unit testing</a></li><li class="chapter-item expanded "><a href="../cbmc/overview/introduction.html"><strong aria-hidden="true">1.3.</strong> CBMC as debugging</a></li></ol></li><li class="chapter-item expanded "><a href="../cbmc/overview/index.html"><strong aria-hidden="true">2.</strong> CBMC proofs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cbmc/overview/checking-assertions.html"><strong aria-hidden="true">2.1.</strong> Checking assertions</a></li><li class="chapter-item expanded "><a href="../cbmc/overview/checking-properties.html"><strong aria-hidden="true">2.2.</strong> Checking properties</a></li><li class="chapter-item expanded "><a href="../cbmc/overview/proof-harnesses.html"><strong aria-hidden="true">2.3.</strong> Proof harnesses</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Controlling CBMC</div></li></ol></li><li class="chapter-item expanded "><a href="../starter-kit/overview/index.html"><strong aria-hidden="true">3.</strong> CBMC proof projects</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> CBMC viewer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Litani</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Continuous integration</div></li><li class="chapter-item expanded "><a href="../faq/index.html"><strong aria-hidden="true">7.</strong> Frequently asked questions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../faq/cbmc.html"><strong aria-hidden="true">7.1.</strong> How does CBMC work?</a></li><li class="chapter-item expanded "><a href="../faq/loop-unwinding.html"><strong aria-hidden="true">7.2.</strong> What is loop unwinding?</a></li><li class="chapter-item expanded "><a href="../faq/memory-model.html"><strong aria-hidden="true">7.3.</strong> How do memory pointers work?</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.4.</strong> How do function pointers work?</div></li><li class="chapter-item expanded "><a href="../faq/malloc.html"><strong aria-hidden="true">7.5.</strong> How does malloc work?</a></li><li class="chapter-item expanded "><a href="../faq/proof-assumptions.html" class="active"><strong aria-hidden="true">7.6.</strong> What is a proof assumption?</a></li><li class="chapter-item expanded "><a href="../faq/termination.html"><strong aria-hidden="true">7.7.</strong> How do I debug why CBMC won't stop?</a></li></ol></li><li class="chapter-item expanded "><a href="../management/index.html"><strong aria-hidden="true">8.</strong> CBMC project management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../management/Plan-your-proof.html"><strong aria-hidden="true">8.1.</strong> Project planning</a></li><li class="chapter-item expanded "><a href="../management/Write-a-good-proof.html"><strong aria-hidden="true">8.2.</strong> Writing a good proof</a></li><li class="chapter-item expanded "><a href="../management/Debug-an-error-trace.html"><strong aria-hidden="true">8.3.</strong> Debugging an error trace</a></li><li class="chapter-item expanded "><a href="../management/Code-for-verification.html"><strong aria-hidden="true">8.4.</strong> Coding for verification</a></li><li class="chapter-item expanded "><a href="../management/Code-review-for-proofs.html"><strong aria-hidden="true">8.5.</strong> Proof evaluation</a></li></ol></li><li class="chapter-item expanded "><a href="../projects.html"><strong aria-hidden="true">9.</strong> CBMC projects</a></li><li class="chapter-item expanded "><a href="../resources.html"><strong aria-hidden="true">10.</strong> CBMC resources</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CBMC</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-a-proof-assumption"><a class="header" href="#what-is-a-proof-assumption">What is a proof assumption?</a></h1>
<p>A proof assumption is anything that limits the applicability of a
statement that has been otherwise proved by CBMC.
An example of a proof assumptions is the assumption that packets coming
off a network are of size at most 1024 bytes.
This proof assumption would arise if the proof harness for a function
modeled an incoming packet as any character buffer of
size at most 1024 characters.  Suppose that we run CBMC with this proof
harness, and CBMC is unable to find any memory safety errors.  We might
be tempted to say that CBMC has proved the function is memory safe.  But
the truth is that CBMC has proved the function is memory safe only when
the function is invoked on a packet of size at most 1024 characters.
We believe that such a proof has value, and that hard-to-find software
issues will be discovered in the course of writing such a proof, but
the result is not absolute proof of memory safety.</p>
<p>Just to clear, every proof in mathematics depends on proof assumptions.
In number theory, a theorem may hold for all integers <code>n</code>, assuming <code>n</code>
is nonzero.  The theorem is powerful because it is applicable to nearly
every integer.  In cryptography, a theorem may hold only if <code>n</code> is the product
of two prime numbers <code>p</code> and <code>q</code> of roughly the same size.  The theorem
may still have powerful applications, but it applies only to a much smaller
set of integers.</p>
<p>Proof assumptions must be clearly and accurately communicated to any
proof reader and to any consumer of the proof.
Doing this right may be the hardest part of proof.
It is particularly important in the context of software proof, however,
because the credibility of the proof tool and the methodology for using the
tool depends on getting this right.
Trust is hard to earn and easy to lose.</p>
<p>The two most common sources of proof assumptions are
<a href="#memory-allocation">memory allocation</a> and
<a href="#function-abstraction">function abstraction</a>.</p>
<h2 id="memory-allocation"><a class="header" href="#memory-allocation">Memory allocation</a></h2>
<p>There are two common proof assumptions about memory.</p>
<h3 id="size"><a class="header" href="#size">Size</a></h3>
<p>One class of assumption is size.  Some are obvious.  If the proof harness
includes</p>
<pre><code class="language-C">  size_t size;
  __CPROVER_assume(size &lt; 100);

  char *buffer = (char *) malloc(size);
</code></pre>
<p>then the buffer is assumed to be of size smaller than 100.
Some are implicit.  If the proof harness includes</p>
<pre><code class="language-C">  size_t size;

  char *buffer = (char *) malloc(size);
</code></pre>
<p>then the buffer is implicitly bounded to the size of the maximum object
that CBMC can model (which is probably smaller than a 64-bit integer, see
our discussion of the <a href="memory-model.html">memory model</a> for more information).</p>
<h3 id="invariants"><a class="header" href="#invariants">Invariants</a></h3>
<p>One class of assumption is well-formedness or implicit data structure
invariants.
Suppose the proof harness includes</p>
<pre><code class="language-C">  typedef struct {
    size_t size;
    char *buffer;
  } buffer_t;

  buffer_t *buffer = (buffer_t *) malloc(sizeof(*buffer));
  buffer-&gt;buffer = (char *) malloc(buffer-&gt;size);
</code></pre>
<p>then the proof harness is implicitly assuming that the pointer <code>buffer-&gt;buffer</code>
is either NULL or a valid pointer to a buffer of size <code>buffer-size</code>.  This
is implicitly assuming an data structure invariant about <code>buffer</code>.
Is this really something you want to assume about a buffer you receive as
input from an untrusted adversary.  Is this really something want to assume
even when <code>buffer-&gt;size == 0</code>?</p>
<h2 id="function-abstraction"><a class="header" href="#function-abstraction">Function abstraction</a></h2>
<p>There are two common kinds of function abstraction with CBMC.</p>
<h3 id="missing-functions"><a class="header" href="#missing-functions">Missing functions</a></h3>
<p>One is implicit function abstraction done automatically by CBMC.</p>
<p>When CBMC encounters
the invocation of a function <code>missing</code> and cannot find a function definition
for <code>missing</code>, CBMC issues a warning &quot;no function body for <code>missing</code>&quot; and
models the function <code>missing</code> as a function that</p>
<ul>
<li>has no side-effects (makes no change to the state), and</li>
<li>returns an arbitrary, unconstrained value of the appropriate return type.</li>
</ul>
<p>This assumption of no side-effects is a serious assumption.  Almost no
functions in C are purely functional.  On the other hand, it is
an easy way to model something like a random number generator returning
a <code>unint64_t</code> used in some cryptographic code under test.
Including the actual function definition of the random number generator
will probably be too much for CBMC, but by leaving the function
undefined (omitting the code defining the random number generator
from the build), CBMC will consider the impact on the property being
testing of every unsigned, 64-bit integer value that can possibly
be returned by the number generator.</p>
<h3 id="stubs"><a class="header" href="#stubs">Stubs</a></h3>
<p>One is explicit function abstraction written by the proof author for the proof.</p>
<p>Consider a cryptographic key generator</p>
<pre><code class="language-C">  int key_generator(void *context, public_key_t *public, private_key_t *private)
</code></pre>
<p>As with the random number generator, including the code for a cryptographic
key generator may be too much for CBMC.  Reconstructing cryptographic keys is,
after all, designed to be intractable!</p>
<p>A reasonable stub for the key generator is:</p>
<pre><code class="language-C">  int key_generator(void *context, public_key_t *public, private_key_t *private)
  {
    __CPROVER_havoc(public);
    __CPROVER_havoc(private);
    int rc;
    return rc;
  }
</code></pre>
<p>The <code>__CPROVER_havoc</code> function fills the objects pointed to by <code>public</code>
and <code>private</code> with arbitrary, unconstrained data.</p>
<p>This stub has the pleasing effect of considering possible every value
(well-formed or not) that could be written to <code>public</code> and <code>private</code>
by the generator,
and considering possible every integer value that could be used as a
return code.</p>
<p>This stub is, however, making the implicit assumption that the pointers
are valid.  A better stub would check that the function is being called
correctly:</p>
<pre><code class="language-C">  int key_generator(void *context, public_key_t *public, private_key_t *private)
  {
    __CPROVER_assert(context, &quot;context is nonnull&quot;);
    __CPROVER_assert(public, &quot;public is nonnull&quot;);
    __CPROVER_assert(private, &quot;private is nonnull&quot;);

    __CPROVER_havoc(public);
    __CPROVER_havoc(private);
    int rc;
    return rc;
  }
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../faq/malloc.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../faq/termination.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../faq/malloc.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../faq/termination.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
